"use strict";function MetaBlock(e,t){var i=this;i.shortcode_tag=e,i.add_btn_class=i.shortcode_tag+"-add-element",i.remove_btn_class=i.shortcode_tag+"-remove-element",i.required_image=t||!1,i.render_new=function(){var e=i.get_element_map(),t=i.make_buttons(e),t=($(".shortcode-ui-edit-"+i.shortcode_tag).append(t),e.element_count);this.hide_all_elements(t),this.add_click_event_handlers(t)},i.render_edit=function(){var e=i.get_element_map(),t=e.element_types,n=e.element_count,e=i.make_buttons(e),a=($(".shortcode-ui-edit-"+i.shortcode_tag).append(e),[]),e=i.get_element_map_array(n,t),t=(e.forEach(function(e){var t=$(".field-block").filter($("div[class$='_"+e+"']")),n=t.children().filter($("input, textarea, select")).map(function(e,t){return $(t).val()}).get().join(""),t=i.required_image?t.find(".attachment-previews .attachment-preview"):null;""!==n||i.required_image&&0!=t.length||a.push(e)}),e.filter(function(e){return!a.includes(e)})),t=0===t.length?0:Math.max.apply(null,t.map(function(e){return parseInt(e.match(/\d+$/g)[0])}));$("."+i.add_btn_class).parent().data("row",t),0!==t&&$("."+i.remove_btn_class).removeAttr("disabled"),a.map(function(e){e=$(".field-block").filter($("div[class$='_"+e+"']"));e.find('input[type="checkbox"], input[type="radio"]').prop("checked",!1).trigger("change"),e.hide()}),e.length-a.length===n&&$("."+i.add_btn_class).attr("disabled","disabled"),this.toggle_images(n),this.add_click_event_handlers(n)},i.add_click_event_handlers=function(r){var o=this;$("."+i.add_btn_class).on("click",function(e){e.preventDefault();var t,e=$(e.currentTarget),n=e.parent().data("row"),a=e.data("element-type");"post"==a&&(t='select[name="post_post_'+(n+1)+'"]',"js-select2-enable"===$(t).data("input-transform"))&&$(t).select2({placeholder:"Select post"}),n<=r&&(o.show_element(++n,a,r),e.parent().data("row",n),$("."+i.remove_btn_class).removeAttr("disabled"),n===r)&&$("."+i.add_btn_class).attr("disabled","disabled")}),$("."+i.remove_btn_class).on("click",function(e){e.preventDefault();var e=$(e.currentTarget),t=e.parent().data("row");0<=t&&(o.hide_element(t--),e.parent().data("row",t),$("."+i.add_btn_class).removeAttr("disabled"),0==t)&&e.attr("disabled","disabled")}),$("input[name=elements_block_style]").off("click").on("click",function(){i.toggle_images(r)})},i.hide_element=function(e){e=$(".field-block").filter($("div[class$='_"+e+"']"));e.find('input[type="checkbox"], input[type="radio"]').prop("checked",!1).trigger("change"),e.find('input:not([type="checkbox"]):not([type="radio"]), textarea').val("").trigger("input").trigger("change"),i.required_image&&e.find(".attachment-previews .attachment-preview .button.remove").trigger("click"),e.hide(300)},i.hide_all_elements=function(e){i.get_element_map_array(e).forEach(function(e){e=$(".field-block").filter($("div[class$='_"+e+"']"));e.find('input[type="checkbox"], input[type="radio"]').prop("checked",!1).trigger("change"),e.hide()})},i.show_element=function(e,t,n){$(".field-block").filter($("div[class$='_"+t+"_"+e+"']")).show(300,function(){$(this).find('input[type="checkbox"][checked], input[type="radio"][checked]').each(function(){$(this).prop("checked",!0).trigger("change")}),i.toggle_images(n),$(".media-frame-content").animate({scrollTop:$(".shortcode-ui-content").prop("scrollHeight")},300)})},i.toggle_images=function(e){i.get_element_map_array(e).forEach(function(e){var t=$(".field-block").filter($("div[class$='title_"+e+"']")).is(":visible"),n="no_image"!=$("input[name=elements_block_style]:checked").val();$(".shortcode-ui-attribute-attachment_"+e).toggle(t&&n)})},i.get_element_map=function(){var n=(n=$("[data-element-type]").map(function(){return $(this).data("element-type")}).toArray()).filter(function(e,t){return n.indexOf(e)==t}),a=(a=$("[data-element-name]").map(function(){return $(this).data("element-name")}).toArray()).filter(function(e,t){return a.indexOf(e)==t}),e=$("[data-element-number]").map(function(){return $(this).data("element-number")}).toArray(),e=Math.max.apply(null,e);return $("[data-hidden]").each(function(){$(this).closest(".field-block").parent("div").hide()}),{element_types:n,element_names:a,element_count:e}},i.get_element_map_array=function(e,n){e=(e=Array.apply(null,Array(e))).map(function(e,t){return t+1});return e=n?e.map(function(t){return n.map(function(e){return e+"_"+t},[])}).reduce(function(e,t){return e.concat(t)}):e},i.make_buttons=function(e){var n='<div data-row="0">',t=e.element_types,a=e.element_names;return a.length!==t.length&&(a=t),t.map(function(e,t){n+='<button class="button button-small '+i.add_btn_class+'" data-element-type="'+e+'">Add '+a[t]+"</button>"}),n+='<button class="button button-small '+i.remove_btn_class+'" disabled="disabled">Remove Element</button></div>'}}jQuery(document).ready(function(){var t=["shortcake_metablock","shortcake_mixed_content_row","shortcake_repeater","shortcake_milestones","shortcake_slideshow","shortcake_world_slideshow","shortcake_link_list","shortcake_people_list","shortcake_accordion_list","shortcake_launcher_card","shortcake_grid_images","shortcake_hero_set","shortcake_steps_set","shortcake_geography_set","shortcake_infographic_cards","shortcake_testimony","shortcake_mc_subscription"],n=["shortcake_grid_images","shortcake_hero_set","shortcake_steps_set","shortcake_infographic_cards","shortcake_testimony"];wp.shortcake.hooks.addAction("shortcode-ui.render_new",function(e){e=e.get("shortcode_tag");t.includes(e)&&new MetaBlock(e,n.includes(e)).render_new()}),wp.shortcake.hooks.addAction("shortcode-ui.render_edit",function(e){e=e.get("shortcode_tag");t.includes(e)&&new MetaBlock(e,n.includes(e)).render_edit()})});
//# sourceMappingURL=maps/admin-blocks.min.js.map
